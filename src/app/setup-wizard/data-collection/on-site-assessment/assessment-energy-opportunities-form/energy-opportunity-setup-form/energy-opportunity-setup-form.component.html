<div class="d-flex w-100 justify-content-end pb-2">
    <button class="me-2 btn btn-secondary btn-sm add-neb-btn" (click)="addNEB()">
        <fa-icon [icon]="faPlus"></fa-icon> Add NEB
    </button>
    <button class="btn btn-dark btn-sm add-neb-btn me-2" (click)="showSuggestedNEBs()">
        <fa-icon [icon]="faSearchPlus"></fa-icon> Search NEBs
    </button>
    <button class="btn btn-danger btn-sm" (click)="showDeleteModal()">
        <fa-icon [icon]="faTrash"></fa-icon> Delete
    </button>
</div>

<form>
    <div class="row">
        <label class="col-sm-5 col-form-label" for="{{'energyOpportunityName_'+energyOpportunity.guid}}">Energy Opportunity Name</label>
        <div class="col-sm-7">
            <input name="{{'energyOpportunityName_'+energyOpportunity.guid}}" type="text" class="form-control" [(ngModel)]="energyOpportunity.name"
                minlength="1" maxlength="42" id="{{'energyOpportunityName_'+energyOpportunity.guid}}" (input)="saveEnergyOpportunity()">
        </div>
    </div>
    <div class="row">
        <label class="col-sm-5 col-form-label" for="{{'opportunityType_'+energyOpportunity.guid}}">Opportunity Type</label>
        <div class="col-sm-7">
            <select name="{{'opportunityType_'+energyOpportunity.guid}}" class="form-select" id="{{'opportunityType_'+energyOpportunity.guid}}"
                [(ngModel)]="energyOpportunity.opportunityType" (change)="saveEnergyOpportunity()">
                <option [ngValue]="undefined">
                    Other
                </option>
                <option *ngFor="let opportunityType of opportunityTypes" [ngValue]="opportunityType.value">
                    {{opportunityType.label}}
                </option>
            </select>
        </div>
    </div>
    <div class="row">
        <label class="col-sm-5 col-form-label" for="{{'implementationCost_'+energyOpportunity.guid}}">Implementation Cost</label>
        <div class="col-sm-7">
            <div class="input-group">
                <input name="{{'implementationCost_'+energyOpportunity.guid}}" type="number" class="form-control"
                    [(ngModel)]="energyOpportunity.implementationCost" id="{{'implementationCost_'+energyOpportunity.guid}}"
                    (input)="saveEnergyOpportunity()">
                <span class="input-group-text">&dollar;</span>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="{{'includeSavings_'+energyOpportunity.guid}}"
                    [(ngModel)]="energyOpportunity.includeSavings" name="{{'includeSavings_'+energyOpportunity.guid}}"
                    (input)="saveEnergyOpportunity()">
                <label class="form-check-label" for="{{'includeSavings_'+energyOpportunity.guid}}">Include Savings</label>
            </div>
        </div>
    </div>

    <ng-container *ngIf="energyOpportunity.includeSavings">
        <div class="row">
            <label class="col-sm-5 col-form-label" for="{{'energySavings_'+energyOpportunity.guid}}">Energy Savings</label>
            <div class="col-sm-7">
                <div class="input-group">
                    <input name="{{'energySavings_'+energyOpportunity.guid}}" type="number" class="form-control"
                        [(ngModel)]="energyOpportunity.energySavings" id="{{'energySavings_'+energyOpportunity.guid}}"
                        (input)="saveEnergyOpportunity()">
                    <span class="input-group-text">MMBtu/yr</span>
                </div>
            </div>
        </div>
        <div class="row">
            <label class="col-sm-5 col-form-label" for="{{'costSavings_'+energyOpportunity.guid}}">Cost Savings</label>
            <div class="col-sm-7">
                <div class="input-group">
                    <input name="{{'costSavings_'+energyOpportunity.guid}}" type="number" class="form-control"
                        [(ngModel)]="energyOpportunity.costSavings" id="{{'costSavings_'+energyOpportunity.guid}}" (input)="saveEnergyOpportunity()">
                    <span class="input-group-text">&dollar;</span>
                </div>
            </div>
        </div>
    </ng-container>
    <div class="row">
        <div class="col-sm-12 col-form-label">
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="{{'includeNotes_'+energyOpportunity.guid}}"
                    [(ngModel)]="energyOpportunity.includeNote" name="{{'includeNotes_'+energyOpportunity.guid}}" (input)="saveEnergyOpportunity()">
                <label class="form-check-label" for="{{'includeNotes_'+energyOpportunity.guid}}">Energy Opportunity Notes</label>
            </div>
        </div>
        <div class="col-sm-12 mb-1" *ngIf="energyOpportunity.includeNote">
            <textarea name="opportunityNotes" type="number" class="form-control" [(ngModel)]="energyOpportunity.notes"
                id="opportunityNotes"></textarea>
        </div>
    </div>
    <app-neb-forms-accordion [energyOpportunity]="energyOpportunity"></app-neb-forms-accordion>
</form>

<div [ngClass]="{'window-overlay': displayDeleteModal}"></div>
<div class="popup" [ngClass]="{'open': displayDeleteModal }">
    <div class="popup-header">Delete this energy opportunity?
        <button type="button" class="btn-close float-end" aria-label="Close" (click)="closeDeleteModal()"></button>
    </div>
    <div class="popup-body">
        <div class="alert alert-info">
            Are you sure you want to delete this energy opportunity?
        </div>
        <hr>
    </div>
    <div class="popup-footer d-flex justify-content-end">
        <button class="btn btn-secondary btn-sm me-2" (click)="closeDeleteModal()">Cancel</button>
        <button class="btn btn-danger btn-sm" (click)="deleteEnergyOpportunity()"><fa-icon [icon]="faTrash"
                class="me-1"></fa-icon>Delete Opportunity</button>
    </div>
</div>